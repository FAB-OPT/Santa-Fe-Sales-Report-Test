<!doctype html>
<html lang="th">
<head>
<meta charset="utf-8">
<title>สรุปคำตอบก่อนยืนยันส่ง</title>
<style>
body{font-family:Arial, sans-serif;background:#f7f7f7;padding:20px}
.container{max-width:900px;margin:auto;background:#fff;padding:20px;border-radius:8px}
h2{text-align:center}
.section{margin-top:20px}
label{display:block;font-weight:bold;margin-bottom:6px}
input[type=text]{width:100%;padding:10px;font-size:16px;border:1px solid #ccc;border-radius:6px}
.btns{margin-top:30px;display:flex;gap:10px;justify-content:flex-end}
.btn-back{background:#d32f2f;color:#fff;border:none;padding:10px 18px;border-radius:6px;cursor:pointer}
.btn-send{background:#2e7d32;color:#fff;border:none;padding:10px 18px;border-radius:6px;cursor:pointer}
</style>
</head>
<body>
<div class="container">
  <h2>สรุปคำตอบก่อนยืนยันส่ง</h2>

  <div class="section">
    <label for="submitter_name">ชื่อผู้ส่งข้อมูล *</label>
    <input type="text" id="submitter_name" placeholder="กรอกชื่อผู้ส่งข้อมูล">
  </div>

  <div class="btns">
    <button class="btn-back" onclick="history.back()">กลับไปแก้ไข</button>
    <button class="btn-send" onclick="submitData()">ยืนยันและส่งข้อมูล</button>
  </div>
</div>

<script>
const WEB_APP_URL = "https://script.google.com/macros/s/AKfycbxx2HRv4M46kWxhxtpXsvw_7pvPAk8Y2P0MdCO1OdQ5xL0C6uEK4CXGWVOvRgtyAyk/exec";

function submitData(){
  const name = document.getElementById('submitter_name').value.trim();
  if(!name){
    alert("กรุณากรอกชื่อผู้ส่งข้อมูล");
    return;
  }

  const params = new URLSearchParams();
  params.append("submitter_name", name);

  fetch(WEB_APP_URL,{
    method:"POST",
    headers:{ "Content-Type":"application/x-www-form-urlencoded" },
    body: params.toString()
  })
  .then(r=>r.json())
  .then(res=>{
    if(res.ok){
      alert("ส่งข้อมูลเรียบร้อย");
    }else{
      alert("เกิดข้อผิดพลาด: "+res.error);
    }
  })
  .catch(err=>alert(err));
}
</script>
</body>
</html>
